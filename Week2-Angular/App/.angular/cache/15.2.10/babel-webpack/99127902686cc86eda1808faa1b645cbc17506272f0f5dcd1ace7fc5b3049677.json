{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"./rating.service\";\nexport class MovieService {\n  constructor(ratingService) {\n    this.ratingService = ratingService;\n    this.movies = [{\n      Title: \"Guardians of the Galaxy Vol. 2\",\n      Year: \"2017\",\n      Runtime: \"136 min\",\n      Genre: \"Action, Adventure, Comedy\",\n      Actors: \"Chris Pratt, Zoe Saldana, Dave Bautista\",\n      Plot: \"The Guardians struggle to keep together as a team while dealing with their personal family issues, notably Star-Lord's encounter with his father, the ambitious celestial being Ego.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BNjM0NTc0NzItM2FlYS00YzEwLWE0YmUtNTA2ZWIzODc2OTgxXkEyXkFqcGdeQXVyNTgwNzIyNzg@._V1_SX300.jpg\",\n      Rating: [9.0]\n    }, {\n      Title: \"The Nun\",\n      Year: \"2018\",\n      Runtime: \"96 min\",\n      Genre: \"Horror, Mystery, Thriller\",\n      Actors: \"Demián Bichir, Taissa Farmiga, Jonas Bloquet\",\n      Plot: \"A priest with a haunted past and a novice on the threshold of her final vows are sent by the Vatican to investigate the death of a young nun in Romania and confront a malevolent force in the form of a demonic nun.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BMjM3NzQ5NDcxOF5BMl5BanBnXkFtZTgwNzM4MTQ5NTM@._V1_SX300.jpg\",\n      Rating: [8.0]\n    }, {\n      Title: \"Cast Away\",\n      Year: \"2000\",\n      Runtime: \"143 min\",\n      Genre: \"Adventure, Drama, Romance\",\n      Actors: \"Tom Hanks, Helen Hunt, Paul Sanchez\",\n      Plot: \"A FedEx executive undergoes a physical and emotional transformation after crash landing on a deserted island.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BN2Y5ZTU4YjctMDRmMC00MTg4LWE1M2MtMjk4MzVmOTE4YjkzXkEyXkFqcGdeQXVyNTc1NTQxODI@._V1_SX300.jpg\",\n      Rating: [8.5]\n    }];\n    localStorage[\"movies\"] = JSON.stringify(this.movies);\n    this.movies.forEach(element => {\n      element.AverageRating = this.getAverageRating(element);\n    });\n    console.log(this.movies);\n  }\n  ngOnInit() {}\n  getMovies() {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n    return this.movies;\n  }\n  addMovie(movie) {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n    this.movies.push(movie);\n    localStorage.setItem(\"movies\", JSON.stringify(this.movies));\n  }\n  getAverageRating(movie) {\n    let total = 0;\n    let average = 0;\n    if (movie.Rating != undefined) {\n      movie.Rating.forEach(element => {\n        total += element;\n      });\n      average = total / movie.Rating.length;\n    }\n    ;\n    return average;\n  }\n  onSavingVote(movie) {\n    let moviesDb = this.getMovies();\n    let currentMovieIndex = moviesDb.findIndex(obj => obj.title == movie.Title);\n    moviesDb[currentMovieIndex].Rating.push(this.ratingService.rateTheMovie());\n  }\n  deleteMovie(movie) {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n    this.movies = this.movies.filter(obj => obj.Title != movie.Title);\n    localStorage.setItem(\"movies\", JSON.stringify(this.movies));\n    return this.movies;\n  }\n  static #_ = this.ɵfac = function MovieService_Factory(t) {\n    return new (t || MovieService)(i0.ɵɵinject(i1.RatingService));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: MovieService,\n    factory: MovieService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"mappings":"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","names":["MovieService","constructor","ratingService","Title","Year","Runtime","Genre","Actors","Plot","Poster","Rating","localStorage","JSON","stringify","movies","forEach","element","AverageRating","getAverageRating","console","log","ngOnInit","getMovies","moviesDb","getItem","parse","addMovie","movie","push","setItem","total","average","undefined","length","onSavingVote","currentMovieIndex","findIndex","obj","title","rateTheMovie","deleteMovie","filter","factory","providedIn"],"sourceRoot":"","sources":["C:\\Facultate\\Internship\\Week2-Angular\\Ex2-MovieApp\\src\\app\\services\\movie.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { movie } from '../models/movie';\nimport { RatingService } from './rating.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MovieService {\n\n  constructor(private ratingService:RatingService) {\n\n    localStorage[\"movies\"] = JSON.stringify(this.movies);\n    this.movies.forEach(element => {\n      element.AverageRating=this.getAverageRating(element);\n    });\n    console.log(this.movies);\n\n  }\n  ngOnInit(): void {\n\n\n  }\n  movies: movie[] = [\n    {\n      Title: \"Guardians of the Galaxy Vol. 2\",\n      Year: \"2017\",\n      Runtime: \"136 min\",\n      Genre: \"Action, Adventure, Comedy\",\n      Actors: \"Chris Pratt, Zoe Saldana, Dave Bautista\",\n      Plot: \"The Guardians struggle to keep together as a team while dealing with their personal family issues, notably Star-Lord's encounter with his father, the ambitious celestial being Ego.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BNjM0NTc0NzItM2FlYS00YzEwLWE0YmUtNTA2ZWIzODc2OTgxXkEyXkFqcGdeQXVyNTgwNzIyNzg@._V1_SX300.jpg\",\n      Rating: [9.0],\n\n    },\n    {\n      Title: \"The Nun\",\n      Year: \"2018\",\n      Runtime: \"96 min\",\n      Genre: \"Horror, Mystery, Thriller\",\n      Actors: \"Demián Bichir, Taissa Farmiga, Jonas Bloquet\",\n      Plot: \"A priest with a haunted past and a novice on the threshold of her final vows are sent by the Vatican to investigate the death of a young nun in Romania and confront a malevolent force in the form of a demonic nun.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BMjM3NzQ5NDcxOF5BMl5BanBnXkFtZTgwNzM4MTQ5NTM@._V1_SX300.jpg\",\n      Rating: [8.0]\n    },\n    {\n      Title: \"Cast Away\",\n      Year: \"2000\",\n      Runtime: \"143 min\",\n      Genre: \"Adventure, Drama, Romance\",\n      Actors: \"Tom Hanks, Helen Hunt, Paul Sanchez\",\n      Plot: \"A FedEx executive undergoes a physical and emotional transformation after crash landing on a deserted island.\",\n      Poster: \"https://m.media-amazon.com/images/M/MV5BN2Y5ZTU4YjctMDRmMC00MTg4LWE1M2MtMjk4MzVmOTE4YjkzXkEyXkFqcGdeQXVyNTc1NTQxODI@._V1_SX300.jpg\",\n      Rating: [8.5]\n    }\n  ]\n\n  getMovies(): any[] {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n    return this.movies;\n  }\n  addMovie(movie: movie): void {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n\n    this.movies.push(movie);\n    localStorage.setItem(\"movies\", JSON.stringify(this.movies));\n\n  }\n\n  getAverageRating(movie:movie){\n    let total=0;\n    let average=0;\n    if(movie.Rating!=undefined){\n      movie.Rating.forEach(element => {\n        total+=element\n    })\n    average=total/movie.Rating.length;\n    };\n\n    return average;\n  }\n\n  onSavingVote(movie:movie){\n    let moviesDb=this.getMovies();\n    let currentMovieIndex=moviesDb.findIndex(obj=>obj.title==movie.Title);\n    moviesDb[currentMovieIndex].Rating.push(this.ratingService.rateTheMovie());\n\n  }\n  deleteMovie(movie: movie) {\n    let moviesDb = localStorage.getItem(\"movies\");\n    if (moviesDb != null) {\n      this.movies = JSON.parse(moviesDb);\n    } else {\n      moviesDb = '';\n      this.movies = JSON.parse(moviesDb);\n    }\n    this.movies = this.movies.filter(obj => obj.Title != movie.Title);\n    localStorage.setItem(\"movies\", JSON.stringify(this.movies));\n    return this.movies;\n  }\n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}